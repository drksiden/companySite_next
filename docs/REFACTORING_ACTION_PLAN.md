# –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –ü–û –ó–ê–í–ï–†–®–ï–ù–ò–Æ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê

## üéØ –¶–µ–ª—å
–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ Next.js 14 –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é: —É–ø—Ä–æ—Å—Ç–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å R2, —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥.

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
- ‚úÖ TypeScript strict mode –≤–∫–ª—é—á–µ–Ω
- ‚úÖ Supabase –∫–ª–∏–µ–Ω—Ç—ã —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ R2 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ (–∫–æ–¥)
- ‚úÖ –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚ö†Ô∏è –ù—É–∂–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è R2
- ‚ö†Ô∏è –ï—Å—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã-–¥—É–±–ª–∏–∫–∞—Ç—ã

## üöÄ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –≠—Ç–∞–ø 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ö–†–ò–¢–ò–ß–ù–û)

#### 1.1 –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ R2 –≤ .env.local
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ .env.local:
R2_ACCOUNT_ID=your-cloudflare-account-id
R2_ACCESS_KEY_ID=your-r2-access-key
R2_SECRET_ACCESS_KEY=your-r2-secret-key
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
R2_PUBLIC_BUCKET=your-bucket-name
R2_PUBLIC_BASE_URL=https://pub-xxxxx.r2.dev
R2_UPLOAD_MAX_MB=20
```

#### 1.2 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Supabase –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –µ—Å—Ç—å –≤ .env.local:
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key (–¥–ª—è admin API)
```

### –≠—Ç–∞–ø 2: –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

#### 2.1 –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∞—Ç–∞–ª–æ–≥–∞
```bash
rm src/components/catalog/CatalogPage.tsx
rm src/components/catalog/EnhancedProductDetailPage.tsx
```

#### 2.2 –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```bash
rm src/components/ImageUpload.tsx
rm src/components/ImageUploadOptimized.tsx
```

#### 2.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –¥—Ä—É–≥–∏–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
```bash
# –ù–∞–π—Ç–∏ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è:
find src -name "*.tsx" -o -name "*.ts" | while read file; do
  basename=$(basename "$file" .tsx .ts)
  if ! grep -r "from.*$basename\|import.*$basename" src/ >/dev/null 2>&1; then
    echo "Potentially unused: $file"
  fi
done
```

### –≠—Ç–∞–ø 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

#### 3.1 –ó–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä
```bash
pnpm dev
```

#### 3.2 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–∞—Ç–∞–ª–æ–≥–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç-—Å–∫—Ä–∏–ø—Ç:
node test-catalog-quick.js

# –ò–ª–∏ —Ä—É—á–Ω–æ:
curl http://localhost:3000/api/catalog/products?page=1&limit=5
curl http://localhost:3000/api/catalog/brands
curl http://localhost:3000/api/catalog/categories
```

#### 3.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü
- –û—Ç–∫—Ä—ã—Ç—å http://localhost:3000/catalog
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
- –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

#### 3.4 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ R2
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å:
curl -X POST http://localhost:3000/api/upload \
  -H "Content-Type: application/json" \
  -d '{"fileName":"test.jpg","contentType":"image/jpeg"}'
```

### –≠—Ç–∞–ø 4: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

#### 4.1 –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ Supabase: `supabase db status`
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `supabase db push`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è public access

#### 4.2 –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ R2
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∫–µ—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±–∞–∫–µ—Ç—É
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å presigned URL –≤—Ä—É—á–Ω—É—é

#### 4.3 –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ —Ç–∏–ø–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã:
pnpm typecheck

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ types/supabase.ts vs services/catalog.ts
```

### –≠—Ç–∞–ø 5: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

#### 5.1 –ò—Å–ø—Ä–∞–≤–∏—Ç—å ESLint warnings
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
# - react-hooks/exhaustive-deps
# - @next/next/no-html-link-for-pages
# - @next/next/no-img-element

pnpm lint:fix
```

#### 5.2 –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `types/catalog.ts` –≤–µ–∑–¥–µ
- –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ç–∏–ø—ã –≤ `types/supabase.ts`

#### 5.3 –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª–µ–π
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 6: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞

#### 6.1 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É
```bash
pnpm build
```

#### 6.2 –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –ø–∞–¥–∞–µ—Ç
- –£–±—Ä–∞—Ç—å `export const runtime = "nodejs"` –∏–∑ —Ä–æ—É—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Node API
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

## üéØ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [ ] Dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- [ ] API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [ ] –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ R2 —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è
- [ ] –°–±–æ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- [ ] –ù–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- [ ] ESLint warnings –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- [ ] –ï–¥–∏–Ω—ã–µ —Ç–∏–ø—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–µ–∑–¥–µ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞

## üö® –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### –ü—Ä–æ–±–ª–µ–º–∞: "Missing R2 environment variables"
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ R2 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ .env.local

### –ü—Ä–æ–±–ª–µ–º–∞: "Database error" –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
**–†–µ—à–µ–Ω–∏–µ**: 
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ö–µ–º—É –ë–î —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç supabase_architecture.md
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "Column does not exist"
**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –≤ services/ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ –ë–î

### –ü—Ä–æ–±–ª–µ–º–∞: –°–±–æ—Ä–∫–∞ –ø–∞–¥–∞–µ—Ç –Ω–∞ image optimization
**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞—Ç—å `runtime = "nodejs"` –∏–∑ /api/images/optimize –µ—Å–ª–∏ Sharp –Ω–µ –Ω—É–∂–µ–Ω

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ç–∏–ø–æ–≤
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–∏–ø—ã –∏–∑ types/catalog.ts, —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏

## üìù CHECKLIST –ü–ï–†–ï–î –ö–û–ú–ú–ò–¢–û–ú

- [ ] `pnpm typecheck` - –∑–µ–ª–µ–Ω—ã–π
- [ ] `pnpm lint` - –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫  
- [ ] `pnpm build` - —É—Å–ø–µ—à–Ω–∞—è —Å–±–æ—Ä–∫–∞
- [ ] –ö–∞—Ç–∞–ª–æ–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ localhost:3000/catalog
- [ ] API —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `node test-catalog-quick.js`
- [ ] –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
- [ ] README.md –∞–∫—Ç—É–∞–ª—å–Ω–∞

## üéâ –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∏–º–µ—Ç—å:
- ‚úÖ –ß–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–µ–∑ –¥—É–±–ª–µ–π
- ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–π –∫–∞—Ç–∞–ª–æ–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- ‚úÖ –ù–∞–¥–µ–∂–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –≤ R2
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 2-4 —á–∞—Å–∞ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ R2 –∏ Supabase)